// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.6/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/accessorSupport/decorators ../../../../core/Collection ../../../../core/HandleRegistry ../../../../core/promiseUtils ../../../../Graphic ../../../layers/GraphicsView ../../engine/graphics/GFXSurface ../../engine/graphics/GFXGroup ../../engine/graphics/GFXObject".split(" "),function(u,v,h,f,e,k,l,m,n,p,q,r,t){return function(g){function d(){for(var a=[],b=0;b<arguments.length;b++)a[b]=
arguments[b];var c=g.apply(this,a)||this;c._frontGroup=new r;c._handles=new l;c._objects=new Map;c.container=new q;c.container.addChild(c._frontGroup);c.watch("graphics",function(){return c._reset()},!0);return c}h(d,g);d.prototype.hitTest=function(a,b){if(!this.view||!this.view.position)return null;a+=this.view.position[0]-window.pageXOffset;b+=this.view.position[1]-window.pageYOffset;return(a=this.container.hitTest(a,b))?m.resolve(a.graphic):null};d.prototype._reset=function(){var a=this;this._handles.remove("graphics");
this._objects.forEach(function(b,c){a._frontGroup.removeChild(b)});this._objects.clear();this.graphics&&(this.graphics.forEach(this._add,this),this._handles.add(this.graphics.on("change",function(b){return a._graphicsChangeHandler(b)}),"graphics"))};d.prototype._add=function(a){if(!this._objects.has(a)){var b=new t;b.graphic=a;b.renderingInfo={symbol:a.symbol};this._objects.set(a,b);this._frontGroup.addChild(b)}};d.prototype._remove=function(a){var b=this._objects.get(a);b&&(this._objects.delete(a),
this._frontGroup.removeChild(b))};d.prototype._graphicsChangeHandler=function(a){for(var b=a.removed,c=0,d=a.added;c<d.length;c++)a=d[c],this._add(a);for(c=0;c<b.length;c++)a=b[c],this._remove(a)};f([e.cast(k.ofType(n))],d.prototype,"graphics",void 0);f([e.property()],d.prototype,"view",void 0);return d=f([e.subclass("esri.views.2d.layers.support.GraphicsView2D")],d)}(e.declared(p))});